<div>
  <div class="page-header">
      <h2>Buildings List</h2>
      <div>
        <select [(ngModel)]="selectedComplexId" (change)="filterBuildings()">
          <option value="0">All Complexes</option>
          <option *ngFor="let complex of complexes" [value]="complex.id">{{complex.identity}}</option>
        </select>
        <button class="btn-add" (click)="openAddBuildingModal()">+ Add Building</button>
      </div>
  </div>

  <div class="buildings-container">
    <div class="building-card" *ngFor="let building of filteredBuildings">
      <h3>{{ building.name }}</h3>
      <p><strong>Complex ID:</strong> {{ building.complex_id }}</p>
      <p><strong>Admin:</strong> {{ adminMap[building.admin_id] || 'N/A' }}</p>
      <button class="btn-delete" (click)="deleteBuilding(building.id)">Delete</button>
    </div>
  </div>

  <app-modal [title]="'Add Building'" [show]="showAddModal" (close)="showAddModal = false">
    <form (ngSubmit)="addBuilding()" #addBuildingForm="ngForm">
      <div class="form-group">
        <label>Building Name</label>
        <input type="text" [(ngModel)]="newBuilding.name" name="name" required>
      </div>

      <div class="form-group">
        <label>Assign Admin</label>
        <select name="admin_id" [(ngModel)]="newBuilding.admin_id" required>
          <option value=0 disabled>Select Admin</option>
          <ng-container *ngFor="let admin of admins">
                  <option *ngIf="admin.role === 'BUILDING_ADMIN'" [value]="admin.id">
                    {{admin.firstName}} {{admin.lastName}}
                  </option>
                </ng-container>
        </select>
      </div>

      <div class="form-group">
        <label>Complex</label>
        <select name="complex_id" [(ngModel)]="newBuilding.complex_id" required>
          <option value=0 disabled>Select Complex</option>
          <option *ngFor="let complex of complexes" [value]="complex.id">{{ complex.identity }}</option>
        </select>
      </div>

      <div class="modal-actions">
        <button type="submit" class="btn-save" [disabled]="!addBuildingForm.form.valid">Add</button>
      </div>
    </form>
  </app-modal>
</div>
