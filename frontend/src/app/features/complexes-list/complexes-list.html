<div>
    <div class="page-header">
        <h2>Complexes List</h2>
        <button class="btn-add" (click)="openAddComplexModal()">+ Add Complex</button>
    </div>

    <div class="card-container">
      <div class="card" *ngFor="let complex of complexes">
        <h3>{{ complex.identity }}</h3>
        <p><strong>Address:</strong> {{ complex.address }}</p>
        <p><strong>Campaign Info:</strong> {{ complex.campaign_info }}</p>
        <p><strong>Admin:</strong> {{ adminMap[complex.admin_id] || 'Unassigned' }}</p>
       <div *ngIf="buildingsMap[complex.id].length > 0; else noBuildings">
          <p><strong>Buildings:</strong></p>
          <ul>
            <li *ngFor="let building of buildingsMap[complex.id]">
            {{ building.name }}
            </li>
          </ul>
        </div>
        <ng-template #noBuildings>
          <p>No buildings yet</p>
        </ng-template>
      </div>
    </div>

    <app-modal [title]="'Add Complex'" [show]="showAddModal" (close)="showAddModal = false">
      <form (ngSubmit)="addComplex()" #addComplexForm="ngForm">
        <div class="form-group">
            <label>Identity</label>
            <input type="text" [(ngModel)]="newComplex.identity" name="identity" required>
        </div>

        <div class="form-group">
            <label>Address</label>
            <input type="text" [(ngModel)]="newComplex.address" name="address" required>
        </div>

        <div class="form-group">
            <label>Campaign Info</label>
            <input type="text" [(ngModel)]="newComplex.campaign_info" name="campaign_info" required>
        </div>

        <div class="form-group">
            <label>Assign Admin</label>
            <select name="admin_id" [(ngModel)]="newComplex.admin_id" required>
                <option value=0 disabled>Select Admin</option>
                <ng-container *ngFor="let admin of admins">
                  <option *ngIf="admin.role === 'COMPLEX_ADMIN'" [value]="admin.id">
                    {{admin.firstName}} {{admin.lastName}}
                  </option>
                </ng-container>
            </select>
        </div>

        <div class="modal-actions">
            <button type="submit" class="btn-save" [disabled]="!addComplexForm.form.valid">Add</button>
        </div>
      </form>
    </app-modal>

</div>
